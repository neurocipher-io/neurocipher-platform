id: ADR-002
title: Data Contracts and Governance
owner: Data Platform
status: Accepted
last_reviewed: 2025-10-23

ADR-002 Data Contracts and Governance

  

  

- Status: Accepted
- Date: 2025-10-23
- Owners: Data Platform

  

  

  

Context

  

  

Upstream sources are heterogeneous. Downstream services need stable models. Contract breaks must not roll into production unnoticed.

  

  

Decision

  

  

Use JSON Schema as the single source of truth. Version with semver. Enforce contract tests in CI before deploy.

  

- Schemas live in libs/contracts/
- Canonical types: Document, Event, Entity, Relation
- Idempotency key: source_id plus content_hash
- PII policy: detect then tokenize or redact at normalization

  

  

  

Alternatives

  

  

1. Protobuf only
2. Avro with Schema Registry
3. Free form pydantic models

  

  

Rejected due to ecosystem fit, infra overhead, or weak language neutrality.

  

  

Consequences

  

  

- Clear change control with semver
- CI blocks on contract drift
- Requires migration jobs for breaking changes

## Acceptance Criteria

- All pipeline-facing contracts (events, files, tables, APIs) are defined as JSON Schema documents, versioned with SemVer, and stored in the canonical locations defined by SRG-001/DCON-001.
- CI pipelines run schema and contract checks (for example via `tests/contract/` and `ops/pipelines/contract-check.yml`) and block merges when contract drift is detected.
- Change rules (patch/minor/major) are enforced: breaking changes (major) are accompanied by documented migrators under `batch/migrators` and rollout plans.
- Data producers and consumers register their schema URNs and compatibility modes in the schema registry as described in DM-004/DM-005.
- Documentation in DCON-001, DM-004, and DM-005 references this ADR as the canonical data contract governance decision.

  

  

  

Change rules

  

  

- Patch: non breaking additions
- Minor: additive optional fields
- Major: breaking changes plus migrator under batch/migrators

  

  

  

Links

  

  

- tests/contract/
- ops/pipelines/contract-check.yml
- 