  

ADR-002 Data Contracts and Governance

  

  

- Status: Accepted
- Date: 2025-10-23
- Owners: Data Platform

  

  

  

Context

  

  

Upstream sources are heterogeneous. Downstream services need stable models. Contract breaks must not roll into production unnoticed.

  

  

Decision

  

  

Use JSON Schema as the single source of truth. Version with semver. Enforce contract tests in CI before deploy.

  

- Schemas live in libs/contracts/
- Canonical types: Document, Event, Entity, Relation
- Idempotency key: source_id plus content_hash
- PII policy: detect then tokenize or redact at normalization

  

  

  

Alternatives

  

  

1. Protobuf only
2. Avro with Schema Registry
3. Free form pydantic models

  

  

Rejected due to ecosystem fit, infra overhead, or weak language neutrality.

  

  

Consequences

  

  

- Clear change control with semver
- CI blocks on contract drift
- Requires migration jobs for breaking changes

  

  

  

Change rules

  

  

- Patch: non breaking additions
- Minor: additive optional fields
- Major: breaking changes plus migrator under batch/migrators

  

  

  

Links

  

  

- tests/contract/
- ops/pipelines/contract-check.yml
- 