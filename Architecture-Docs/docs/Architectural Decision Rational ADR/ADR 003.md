  

ADR-003 Retrieval Architecture

  

  

- Status: Accepted
- Date: 2025-10-23
- Owners: Search Lead

  

  

  

Context

  

  

Users need high recall and precision across mixed modalities. Vector only is not sufficient for lexical matches and filters. Keyword only is weak on semantic similarity.

  

  

Decision

  

  

Use hybrid retrieval with reciprocal rank fusion.

  

- Vector store: Weaviate collections per modality
- Keyword store: OpenSearch Serverless with BM25
- Fusion: RRF with tunable k and weights per query class
- Metadata filters evaluated in both engines then intersected

  

  

  

Alternatives

  

  

1. Vector only
2. Keyword only
3. One engine for both roles

  

  

Rejected due to quality or feature gaps.

  

  

Consequences

  

  

- Better relevance across heterogeneous inputs
- Two systems to operate and monitor
- Indexing pipeline writes to both backends

  

  

  

SLIs

  

  

- Recall@10 target 0.9 on golden set
- p95 query latency 900 ms uncached
- Freshness lag under 5 minutes streaming

  

  

  

Links

  

  

- services/index/
- services/api/handlers/query.py
- tools/eval/